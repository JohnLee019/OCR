<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ë¬¸ì¥ë³„ TTS í”Œë ˆì´ì–´</title>
</head>
<body>
    <h1>ğŸ“– ë¬¸ì¥ ë‹¨ìœ„ ì˜¤ë””ì˜¤ ì¬ìƒ</h1>
    <p id="status">ì¤€ë¹„ ì¤‘...</p>
    <audio id="player" controls autoplay></audio>

    <script>
        let currentIndex = 0;
        let totalSentences = 0;
        const player = document.getElementById("player");
        const status = document.getElementById("status");

        async function getSentenceCount() {
            const res = await fetch("/api/get-sentence-count");
            const data = await res.json();
            return data.count;
        }

        async function playSentence(index) {
            status.innerText = `ì¬ìƒ ì¤‘: ë¬¸ì¥ ${index + 1}ë²ˆ`;
            player.src = `/api/get-audio/${index}`;
            player.play();
        }

        player.addEventListener("ended", () => {
            currentIndex++;
            if (currentIndex < totalSentences) {
                playSentence(currentIndex);
            } else {
                status.innerText = "âœ… ëª¨ë“  ë¬¸ì¥ ì¬ìƒ ì™„ë£Œ!";
            }
        });

        window.onload = async () => {
            totalSentences = await getSentenceCount();
            if (totalSentences > 0) {
                playSentence(currentIndex);
            } else {
                status.innerText = "âŒ ì¬ìƒí•  ë¬¸ì¥ì´ ì—†ìŠµë‹ˆë‹¤.";
            }
        };
    </script>
</body>
</html>
